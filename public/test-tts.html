<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å°å°¼è¯­ TTS æµ‹è¯•</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      max-width: 600px;
      margin: 40px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    .card {
      background: white;
      border-radius: 12px;
      padding: 24px;
      margin-bottom: 16px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    h1 {
      color: #333;
      font-size: 24px;
      margin-bottom: 8px;
    }
    .subtitle {
      color: #666;
      font-size: 14px;
      margin-bottom: 24px;
    }
    .test-item {
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 1px solid #eee;
    }
    .test-item:last-child {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0;
    }
    .word {
      font-size: 28px;
      font-weight: bold;
      color: #4F6FFF;
      margin-bottom: 8px;
    }
    .meaning {
      color: #666;
      margin-bottom: 12px;
    }
    button {
      background: #4F6FFF;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 12px 24px;
      font-size: 16px;
      cursor: pointer;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.3s;
    }
    button:active {
      transform: scale(0.98);
      background: #3d5ae0;
    }
    .status {
      margin-top: 12px;
      padding: 12px;
      border-radius: 8px;
      font-size: 14px;
      display: none;
    }
    .status.show {
      display: block;
    }
    .status.success {
      background: #e8f5e9;
      color: #2e7d32;
    }
    .status.error {
      background: #ffebee;
      color: #c62828;
    }
    .status.info {
      background: #e3f2fd;
      color: #1565c0;
    }
    .info-box {
      background: #fff3cd;
      border: 1px solid #ffc107;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
      font-size: 14px;
      color: #856404;
    }
    .long-text {
      background: #f5f5f5;
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 12px;
      font-size: 14px;
      line-height: 1.6;
      color: #333;
      max-height: 150px;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>ğŸ¤ å°å°¼è¯­ TTS æµ‹è¯•</h1>
    <p class="subtitle">æµ‹è¯•æµè§ˆå™¨åŸç”Ÿè¯­éŸ³åˆæˆï¼ˆWeb Speech APIï¼‰</p>
    
    <div class="info-box">
      <strong>ğŸ“± ä½¿ç”¨è¯´æ˜ï¼š</strong><br>
      1. åœ¨ iPhone Safari æˆ– Chrome ä¸­æ‰“å¼€æ­¤é¡µé¢<br>
      2. ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æµ‹è¯•å‘éŸ³<br>
      3. å¯¹æ¯”å•è¯å’Œé•¿æ–‡æœ¬çš„å‘éŸ³è´¨é‡<br>
      4. åé¦ˆç»™æˆ‘ä½ çš„å¬æ„Ÿ âœ¨
    </div>

    <div class="test-item">
      <h3>æµ‹è¯• 1ï¼šå•ä¸ªå•è¯</h3>
      <div class="word">keluarga</div>
      <div class="meaning">å®¶åº­</div>
      <button onclick="speakWord('keluarga', 1)">
        <span>ğŸ”Š</span>
        <span>æ’­æ”¾å•è¯å‘éŸ³</span>
      </button>
      <div id="status-1" class="status"></div>
    </div>

    <div class="test-item">
      <h3>æµ‹è¯• 2ï¼šå¤šä¸ªå•è¯</h3>
      <div class="word">rumah</div>
      <div class="meaning">æˆ¿å­</div>
      <button onclick="speakWord('rumah', 2)">
        <span>ğŸ”Š</span>
        <span>æ’­æ”¾å•è¯å‘éŸ³</span>
      </button>
      <div id="status-2" class="status"></div>
    </div>

    <div class="test-item">
      <h3>æµ‹è¯• 3ï¼šçŸ­å¥å­</h3>
      <div class="long-text" style="max-height: 50px;">
        Selamat pagi, apa kabar?
      </div>
      <button onclick="speakWord('Selamat pagi, apa kabar?', 3)">
        <span>ğŸ”Š</span>
        <span>æ’­æ”¾å¥å­å‘éŸ³</span>
      </button>
      <div id="status-3" class="status"></div>
    </div>

    <div class="test-item">
      <h3>æµ‹è¯• 4ï¼šé•¿æ®µè½ï¼ˆä½ çš„å®é™…æ–‡æœ¬ï¼‰</h3>
      <div class="long-text">
        Serangan Balik kepada Portugis. Terdapat upaya untuk meruntuhkan dua abad hegemoni Portugis di Malaka. Hal ini dilakukan oleh beberapa kerajaan dari Nusantara. Tercatat beberapa serangan diberikan oleh Demak (1512, 1513, dan 1535); Johor (1518 dan 1585); Aceh (1537, 1547, 1568, 1572, 1575, 1583, 1615, 1629, dan 1639); Jepara (1551 dan 1574), dan Gabungan pasukan Johor dan Belanda (1606 dan 1640-1).
      </div>
      <button onclick="speakLongText(4)">
        <span>ğŸ”Š</span>
        <span>æ’­æ”¾é•¿æ®µè½å‘éŸ³</span>
      </button>
      <div id="status-4" class="status"></div>
    </div>
  </div>

  <div class="card">
    <h3>ğŸ” ç³»ç»Ÿä¿¡æ¯</h3>
    <div id="system-info" style="font-size: 14px; color: #666;"></div>
  </div>

  <script>
    // æ£€æµ‹æµè§ˆå™¨æ”¯æŒ
    function checkSupport() {
      const info = document.getElementById('system-info');
      if ('speechSynthesis' in window) {
        info.innerHTML = `
          âœ… æµè§ˆå™¨æ”¯æŒ Web Speech API<br>
          ğŸ“± è®¾å¤‡ï¼š${navigator.userAgent.includes('iPhone') ? 'iPhone' : navigator.userAgent.includes('Android') ? 'Android' : 'æ¡Œé¢æµè§ˆå™¨'}<br>
          ğŸŒ æµè§ˆå™¨ï¼š${navigator.userAgent.includes('Safari') ? 'Safari' : navigator.userAgent.includes('Chrome') ? 'Chrome' : 'å…¶ä»–'}
        `;
        
        // åˆ—å‡ºå¯ç”¨çš„è¯­éŸ³
        speechSynthesis.onvoiceschanged = () => {
          const voices = speechSynthesis.getVoices();
          const indonesianVoices = voices.filter(v => v.lang.startsWith('id'));
          
          if (indonesianVoices.length > 0) {
            info.innerHTML += `<br>âœ… æ‰¾åˆ° ${indonesianVoices.length} ä¸ªå°å°¼è¯­è¯­éŸ³åŒ…`;
            indonesianVoices.forEach(v => {
              info.innerHTML += `<br>ã€€ã€€- ${v.name} (${v.lang})`;
            });
          } else {
            info.innerHTML += `<br>âš ï¸ æœªæ‰¾åˆ°å°å°¼è¯­è¯­éŸ³åŒ…ï¼Œå°†ä½¿ç”¨é»˜è®¤è¯­éŸ³`;
          }
        };
      } else {
        info.innerHTML = 'âŒ æµè§ˆå™¨ä¸æ”¯æŒ Web Speech API';
      }
    }

    // æ’­æ”¾è¯­éŸ³
    function speakWord(text, testId) {
      const statusEl = document.getElementById(`status-${testId}`);
      
      // åœæ­¢å½“å‰æ’­æ”¾
      speechSynthesis.cancel();
      
      // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
      statusEl.className = 'status show info';
      statusEl.textContent = 'â³ æ­£åœ¨å‡†å¤‡è¯­éŸ³...';
      
      try {
        const utterance = new SpeechSynthesisUtterance(text);
        
        // è®¾ç½®å°å°¼è¯­
        utterance.lang = 'id-ID';
        
        // å°è¯•é€‰æ‹©å°å°¼è¯­è¯­éŸ³
        const voices = speechSynthesis.getVoices();
        const indonesianVoice = voices.find(v => v.lang.startsWith('id'));
        if (indonesianVoice) {
          utterance.voice = indonesianVoice;
        }
        
        // è®¾ç½®è¯­éŸ³å‚æ•°
        utterance.rate = 0.9; // ç¨æ…¢ä¸€ç‚¹ï¼Œæ›´æ¸…æ™°
        utterance.pitch = 1.0;
        utterance.volume = 1.0;
        
        // å¼€å§‹æ’­æ”¾
        utterance.onstart = () => {
          statusEl.className = 'status show success';
          statusEl.textContent = 'â–¶ï¸ æ­£åœ¨æ’­æ”¾...';
        };
        
        // æ’­æ”¾ç»“æŸ
        utterance.onend = () => {
          statusEl.className = 'status show success';
          statusEl.textContent = 'âœ… æ’­æ”¾å®Œæˆ';
          setTimeout(() => {
            statusEl.className = 'status';
          }, 2000);
        };
        
        // é”™è¯¯å¤„ç†
        utterance.onerror = (event) => {
          statusEl.className = 'status show error';
          statusEl.textContent = `âŒ é”™è¯¯ï¼š${event.error}`;
        };
        
        speechSynthesis.speak(utterance);
        
      } catch (error) {
        statusEl.className = 'status show error';
        statusEl.textContent = `âŒ é”™è¯¯ï¼š${error.message}`;
      }
    }

    // æ’­æ”¾é•¿æ–‡æœ¬
    function speakLongText(testId) {
      const longText = `Serangan Balik kepada Portugis. Terdapat upaya untuk meruntuhkan dua abad hegemoni Portugis di Malaka. Hal ini dilakukan oleh beberapa kerajaan dari Nusantara. Tercatat beberapa serangan diberikan oleh Demak (1512, 1513, dan 1535); Johor (1518 dan 1585); Aceh (1537, 1547, 1568, 1572, 1575, 1583, 1615, 1629, dan 1639); Jepara (1551 dan 1574), dan Gabungan pasukan Johor dan Belanda (1606 dan 1640-1). Portugis melihat Aceh sebagai rival yang paling berbahaya.`;
      speakWord(longText, testId);
    }

    // é¡µé¢åŠ è½½æ—¶æ£€æµ‹æ”¯æŒ
    checkSupport();
    
    // ç¡®ä¿è¯­éŸ³åˆ—è¡¨åŠ è½½
    if ('speechSynthesis' in window) {
      speechSynthesis.getVoices();
    }
  </script>
</body>
</html>

